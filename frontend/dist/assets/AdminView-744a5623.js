import{d as y,r as d,w as v,c as l,a as e,t as i,F as c,e as _,o as a,f as g}from"./index-be418729.js";const b={key:0},C=e("p",null,"You probably don't have access to this resource :)",-1),w=[C],$={key:1},V={key:2},P=e("h1",null,"Admin Panel",-1),A=e("hr",null,null,-1),B=e("h2",null,"Users",-1),E={class:"table-container"},M={key:0},N={key:1},j=["onClick"],x={key:0},L={key:1},S=e("br",null,null,-1),U=e("br",null,null,-1),F=e("h2",null,"Votes by User",-1),O={class:"table-container"},D=e("thead",null,[e("tr",null,[e("th",null,"Voter"),e("th",null,"Names")])],-1),I={key:0},f="/api",T=y({__name:"AdminView",setup(K){const o=d(""),h=d([]),m=d(""),r=d(1);v(async()=>{const n=`${f}/voters`;o.value=await(await fetch(n)).json()}),v(async()=>{const n=`${f}/votes/voters`;h.value=await(await fetch(n)).json()});function k(n){console.log("Marking user as paid:",n),fetch("/api/payments/"+n,{method:"POST"}).then(t=>t.json()).then(t=>{console.log("Success:",t),t.message.includes("has been processed")?(console.log("Marking as paid successful"),o.value=o.value.map(s=>(s.email===n&&(s.has_paid=!0),s))):(console.log("Marking as paid failed"),alert("Marking as paid failed: "+t.message))}).catch(t=>{console.error("Error:",t)})}function u(n){m.value===n?r.value*=-1:(m.value=n,r.value=1),o.value=[...o.value].sort((t,s)=>t[n]>s[n]?r.value:t[n]<s[n]?-r.value:0)}return(n,t)=>o.value?o.value.message?(a(),l("div",$,[e("p",null,i(o.value.message),1)])):(a(),l("div",V,[P,A,B,e("div",E,[e("table",null,[e("thead",null,[e("tr",null,[e("th",{onClick:t[0]||(t[0]=s=>u("has_voted"))},"Voted"),e("th",{onClick:t[1]||(t[1]=s=>u("has_paid"))},"Paid"),e("th",{onClick:t[2]||(t[2]=s=>u("name"))},"Name"),e("th",{onClick:t[3]||(t[3]=s=>u("last_name"))},"Last Name"),e("th",{onClick:t[4]||(t[4]=s=>u("email"))},"Email")])]),e("tbody",null,[(a(!0),l(c,null,_(o.value,s=>(a(),l("tr",{key:s.id},[e("td",null,[s.has_voted?(a(),l("span",M,"âœ…")):(a(),l("span",N,"âŒ"))]),e("td",null,[e("a",{onClick:p=>k(s.email)},[s.has_paid?(a(),l("span",x,"ðŸ’°")):(a(),l("span",L,"âŒ"))],8,j)]),e("td",null,i(s.name),1),e("td",null,i(s.last_name),1),e("td",null,i(s.email),1)]))),128))])])]),S,U,F,e("div",O,[e("table",null,[D,e("tbody",null,[(a(!0),l(c,null,_(h.value,s=>(a(),l("tr",null,[e("td",null,i(s.email),1),s.names?(a(),l("td",I,[(a(!0),l(c,null,_(s.names,p=>(a(),l("span",null,i(p)+", ",1))),256))])):g("",!0)]))),256))])])])])):(a(),l("div",b,w))}});export{T as default};
